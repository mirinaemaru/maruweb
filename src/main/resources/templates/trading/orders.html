<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>Ï£ºÎ¨∏ Ï°∞Ìöå</title>
    <th:block layout:fragment="extra-css">
        <style>
                .orders-page {
                    padding: 30px;
                    max-width: 1800px;
                    margin: 0 auto;
                }
                .page-header {
                    margin-bottom: 40px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    padding: 40px;
                    border-radius: 16px;
                    color: white;
                    box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
                }
                .page-header h1 {
                    font-size: 36px;
                    font-weight: 700;
                    margin-bottom: 10px;
                    display: flex;
                    align-items: center;
                    gap: 15px;
                }
                .page-header p {
                    font-size: 16px;
                    opacity: 0.95;
                }
                .filter-section {
                    background: white;
                    padding: 28px;
                    border-radius: 16px;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    margin-bottom: 30px;
                    border: 1px solid rgba(0,0,0,0.04);
                }
                .advanced-filter-toggle {
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                    cursor: pointer;
                    margin-bottom: 20px;
                    padding-bottom: 15px;
                    border-bottom: 2px solid #f0f0f0;
                }
                .advanced-filter-toggle h3 {
                    font-size: 16px;
                    font-weight: 600;
                    color: #333;
                    margin: 0;
                }
                .toggle-icon {
                    font-size: 20px;
                    transition: transform 0.3s;
                }
                .toggle-icon.open {
                    transform: rotate(180deg);
                }
                .advanced-filter-content {
                    display: none;
                    margin-bottom: 20px;
                }
                .advanced-filter-content.show {
                    display: block;
                }
                .filter-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 20px;
                    margin-bottom: 20px;
                }
                .filter-group {
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                }
                .filter-group label {
                    font-weight: 600;
                    color: #333;
                    font-size: 14px;
                }
                .filter-group input,
                .filter-group select {
                    padding: 10px 15px;
                    border: 2px solid #e0e0e0;
                    border-radius: 6px;
                    font-size: 14px;
                    transition: all 0.3s;
                }
                .filter-group input:focus,
                .filter-group select:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                }
                .filter-actions {
                    display: flex;
                    gap: 10px;
                }
                .filter-actions button {
                    padding: 10px 24px;
                    border: none;
                    border-radius: 6px;
                    font-size: 14px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .btn-filter {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                }
                .btn-filter:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
                }
                .btn-reset {
                    background: #e0e0e0;
                    color: #333;
                }
                .btn-reset:hover {
                    background: #d0d0d0;
                }
                .filter-form {
                    display: flex;
                    gap: 15px;
                    align-items: center;
                }
                .filter-form label {
                    font-weight: 600;
                    color: #333;
                }
                .filter-form select {
                    padding: 10px 15px;
                    border: 2px solid #e0e0e0;
                    border-radius: 6px;
                    font-size: 14px;
                    flex: 1;
                    min-width: 200px;
                    max-width: calc(100% - 250px);
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .filter-form select:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                }
                .filter-form button {
                    padding: 10px 24px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    border-radius: 6px;
                    font-size: 14px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .filter-form button:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
                }
                .orders-table-container {
                    background: white;
                    border-radius: 16px;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    overflow: hidden;
                    border: 1px solid rgba(0,0,0,0.04);
                }
                .orders-table {
                    width: 100%;
                    border-collapse: collapse;
                }
                .orders-table thead {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                }
                .orders-table th {
                    padding: 15px 12px;
                    text-align: left;
                    font-weight: 600;
                    font-size: 13px;
                    text-transform: uppercase;
                }
                .orders-table td {
                    padding: 15px 12px;
                    border-bottom: 1px solid #f0f0f0;
                    font-size: 14px;
                }
                .orders-table tbody tr:hover {
                    background: #f8f9fa;
                }
                .orders-table tbody tr:last-child td {
                    border-bottom: none;
                }
                .badge {
                    display: inline-block;
                    padding: 6px 12px;
                    border-radius: 6px;
                    font-size: 11px;
                    font-weight: 700;
                    text-transform: uppercase;
                    letter-spacing: 0.3px;
                }
                .badge-buy {
                    background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                    color: #721c24;
                }
                .badge-sell {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                }
                .badge-filled {
                    background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
                    color: #0a472e;
                }
                .badge-pending {
                    background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
                    color: #856404;
                }
                .badge-cancelled {
                    background: #e8e8e8;
                    color: #666;
                }
                .badge-rejected {
                    background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                    color: #721c24;
                }
                .empty-state {
                    text-align: center;
                    padding: 60px 20px;
                    background: white;
                    border-radius: 8px;
                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                }
                .empty-icon {
                    font-size: 64px;
                    margin-bottom: 20px;
                }
                .empty-message {
                    color: #666;
                    font-size: 18px;
                }
                .price-positive {
                    color: #dc3545;
                    font-weight: 600;
                }
                .price-negative {
                    color: #0066ff;
                    font-weight: 600;
                }
                .alert {
                    padding: 20px 28px;
                    border-radius: 12px;
                    margin-bottom: 30px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                    animation: slideDown 0.3s ease-out;
                }
                @keyframes slideDown {
                    from {
                        opacity: 0;
                        transform: translateY(-10px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                .alert-error {
                    background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
                    border: 1px solid #f5c6cb;
                }
                .alert-title {
                    font-size: 20px;
                    font-weight: 700;
                    color: #721c24;
                    margin-bottom: 10px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                .alert-message {
                    color: #721c24;
                    font-size: 15px;
                    line-height: 1.6;
                    margin-bottom: 12px;
                }
                .alert-detail {
                    background: rgba(255,255,255,0.6);
                    padding: 12px 16px;
                    border-radius: 8px;
                    font-family: monospace;
                    font-size: 13px;
                    color: #721c24;
                    margin-top: 12px;
                    word-break: break-all;
                }
                .alert-help {
                    background: #fff3cd;
                    border: 1px solid #ffeaa7;
                    padding: 18px;
                    border-radius: 10px;
                    margin-top: 15px;
                }
                .alert-help h4 {
                    color: #856404;
                    font-size: 16px;
                    margin: 0 0 12px 0;
                }
                .alert-help ol {
                    color: #856404;
                    margin: 0;
                    padding-left: 20px;
                    line-height: 1.8;
                }
                .alert-help pre {
                    background: white;
                    padding: 10px;
                    border-radius: 6px;
                    margin: 8px 0;
                    font-size: 12px;
                    overflow-x: auto;
                }
                .action-buttons {
                    display: flex;
                    gap: 5px;
                }
                .btn-cancel {
                    padding: 6px 12px;
                    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    color: white;
                    border: none;
                    border-radius: 4px;
                    font-size: 12px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .btn-cancel:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 10px rgba(245, 87, 108, 0.4);
                }
                .btn-modify {
                    padding: 6px 12px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    border-radius: 4px;
                    font-size: 12px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .btn-modify:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
                }
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    align-items: center;
                    justify-content: center;
                }
                .modal.active {
                    display: flex;
                }
                .modal-content {
                    background: white;
                    padding: 30px;
                    border-radius: 12px;
                    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
                    max-width: 500px;
                    width: 90%;
                }
                .modal-header {
                    font-size: 20px;
                    font-weight: 700;
                    margin-bottom: 20px;
                    color: #333;
                }
                .modal-form-group {
                    margin-bottom: 15px;
                }
                .modal-form-group label {
                    display: block;
                    font-weight: 600;
                    margin-bottom: 5px;
                    color: #333;
                }
                .modal-form-group input {
                    width: 100%;
                    padding: 10px;
                    border: 2px solid #e0e0e0;
                    border-radius: 6px;
                    font-size: 14px;
                    box-sizing: border-box;
                }
                .modal-form-group input:focus {
                    outline: none;
                    border-color: #667eea;
                }
                .modal-actions {
                    display: flex;
                    gap: 10px;
                    margin-top: 20px;
                }
                .btn-submit {
                    flex: 1;
                    padding: 12px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    border: none;
                    border-radius: 6px;
                    font-size: 14px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .btn-submit:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
                }
                .btn-close {
                    flex: 1;
                    padding: 12px;
                    background: #e0e0e0;
                    color: #333;
                    border: none;
                    border-radius: 6px;
                    font-size: 14px;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.3s;
                }
                .btn-close:hover {
                    background: #d0d0d0;
                }
                .alert-success {
                    padding: 20px 28px;
                    border-radius: 12px;
                    margin-bottom: 30px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
                    border: 1px solid #c3e6cb;
                    animation: slideDown 0.3s ease-out;
                }
                .alert-success .alert-title {
                    font-size: 20px;
                    font-weight: 700;
                    color: #155724;
                    margin-bottom: 10px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                .alert-success .alert-message {
                    color: #155724;
                    font-size: 15px;
                    line-height: 1.6;
                }
            </style>
    </th:block>
</head>
<body>
    <div layout:fragment="content">
        <div class="orders-page">
                        <div class="page-header">
                            <h1>üìà Ï£ºÎ¨∏ Ï°∞Ìöå</h1>
                            <p>Í≥ÑÏ¢åÎ≥Ñ Ï£ºÎ¨∏ ÎÇ¥Ïó≠ÏùÑ Ï°∞ÌöåÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                        </div>
        
                        <!-- Success Message -->
                        <div th:if="${message}" class="alert alert-success">
                            <div class="alert-title">‚úÖ ÏÑ±Í≥µ</div>
                            <div class="alert-message" th:text="${message}">Operation successful</div>
                        </div>

                        <!-- API Connection Error Alert -->
                        <div th:if="${error}" class="alert alert-error">
                            <div class="alert-title">‚ö†Ô∏è API Ïó∞Í≤∞ Ïò§Î•ò</div>
                            <div class="alert-message" th:text="${error}">
                                Trading System APIÏóê Ïó∞Í≤∞Ìï† Ïàò ÏóÜÏäµÎãàÎã§.
                            </div>
                            <div th:if="${errorDetail}" class="alert-detail">
                                <strong>ÏÉÅÏÑ∏ Ï†ïÎ≥¥:</strong><br>
                                <span th:text="${errorDetail}">Error details</span>
                            </div>
                            <div class="alert-help">
                                <h4>Ìï¥Í≤∞ Î∞©Î≤ï</h4>
                                <ol>
                                    <li>Trading System API ÏÑúÎ≤ÑÍ∞Ä Ïã§Ìñâ Ï§ëÏù∏ÏßÄ ÌôïÏù∏ÌïòÏÑ∏Ïöî (Ìè¨Ìä∏ 8099)</li>
                                    <li>ÌÑ∞ÎØ∏ÎÑêÏóêÏÑú Îã§Ïùå Î™ÖÎ†πÏñ¥Î•º Ïã§ÌñâÌïòÏÑ∏Ïöî:
                                        <pre>cd /Users/changsupark/projects/cautostock
        ./run-with-env.sh</pre>
                                    </li>
                                    <li>Health Check ÌôïÏù∏: <a href="http://localhost:8099/health" target="_blank" style="color: #007bff;">http://localhost:8099/health</a></li>
                                </ol>
                            </div>
                        </div>
        
                        <div class="filter-section">
                            <div class="advanced-filter-toggle" onclick="toggleAdvancedFilter()">
                                <h3>üîç Í≥†Í∏â ÌïÑÌÑ∞</h3>
                                <span class="toggle-icon" id="toggleIcon">‚ñº</span>
                            </div>
                            <div class="advanced-filter-content" id="advancedFilterContent">
                                <form method="get" th:action="@{/trading/orders}">
                                    <div class="filter-grid">
                                        <div class="filter-group">
                                            <label for="accountId">Í≥ÑÏ¢å ÏÑ†ÌÉù</label>
                                            <select id="accountId" name="accountId">
                                                <option value="">Ï†ÑÏ≤¥ Í≥ÑÏ¢å</option>
                                                <option th:each="account : ${accounts}"
                                                        th:value="${account.accountId}"
                                                        th:text="${account.alias} + ' (' + ${account.accountId} + ')'"
                                                        th:selected="${account.accountId == selectedAccountId}">
                                                    Account
                                                </option>
                                            </select>
                                        </div>
                                        <div class="filter-group">
                                            <label for="startDate">ÏãúÏûëÏùº</label>
                                            <input type="date" id="startDate" name="startDate"
                                                   th:value="${param.startDate != null ? param.startDate[0] : #temporals.format(#temporals.createToday(), 'yyyy-MM-dd')}"/>
                                        </div>
                                        <div class="filter-group">
                                            <label for="endDate">Ï¢ÖÎ£åÏùº</label>
                                            <input type="date" id="endDate" name="endDate"
                                                   th:value="${param.endDate != null ? param.endDate[0] : #temporals.format(#temporals.createToday(), 'yyyy-MM-dd')}"/>
                                        </div>
                                        <div class="filter-group">
                                            <label for="status">Ï£ºÎ¨∏ ÏÉÅÌÉú</label>
                                            <select id="status" name="status">
                                                <option value="">Ï†ÑÏ≤¥ ÏÉÅÌÉú</option>
                                                <option value="PENDING" th:selected="${param.status != null && param.status[0] == 'PENDING'}">ÎåÄÍ∏∞</option>
                                                <option value="FILLED" th:selected="${param.status != null && param.status[0] == 'FILLED'}">Ï≤¥Í≤∞</option>
                                                <option value="CANCELLED" th:selected="${param.status != null && param.status[0] == 'CANCELLED'}">Ï∑®ÏÜå</option>
                                                <option value="REJECTED" th:selected="${param.status != null && param.status[0] == 'REJECTED'}">Í±∞Î∂Ä</option>
                                            </select>
                                        </div>
                                        <div class="filter-group">
                                            <label for="symbol">Ï¢ÖÎ™© ÏΩîÎìú</label>
                                            <input type="text" id="symbol" name="symbol" placeholder="Ïòà: 005930"
                                                   th:value="${param.symbol != null ? param.symbol[0] : ''}"/>
                                        </div>
                                        <div class="filter-group">
                                            <label for="side">Îß§Îß§ Íµ¨Î∂Ñ</label>
                                            <select id="side" name="side">
                                                <option value="">Ï†ÑÏ≤¥</option>
                                                <option value="BUY" th:selected="${param.side != null && param.side[0] == 'BUY'}">Îß§Ïàò</option>
                                                <option value="SELL" th:selected="${param.side != null && param.side[0] == 'SELL'}">Îß§ÎèÑ</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="filter-actions">
                                        <button type="submit" class="btn-filter">ÌïÑÌÑ∞ Ï†ÅÏö©</button>
                                        <button type="button" class="btn-reset" onclick="resetFilters()">Ï¥àÍ∏∞Ìôî</button>
                                        <button type="button" class="btn-export" onclick="exportToExcel()" style="background: #28a745; color: white;">üì• Excel Export</button>
                                    </div>
                                </form>
                            </div>
                        </div>
        
                        <div th:if="${orders != null && !orders.isEmpty()}" class="orders-table-container">
                            <table class="orders-table">
                                <thead>
                                    <tr>
                                        <th>Ï£ºÎ¨∏ÏùºÏãú</th>
                                        <th>Ï¢ÖÎ™©Î™Ö</th>
                                        <th>Ï¢ÖÎ™©ÏΩîÎìú</th>
                                        <th>Íµ¨Î∂Ñ</th>
                                        <th>Ï£ºÎ¨∏Í∞ÄÍ≤©</th>
                                        <th>Ï£ºÎ¨∏ÏàòÎüâ</th>
                                        <th>Ï≤¥Í≤∞ÏàòÎüâ</th>
                                        <th>ÏÉÅÌÉú</th>
                                        <th>Í¥ÄÎ¶¨</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="order : ${orders}">
                                        <td>
                                            <a th:href="@{/trading/orders/{id}(id=${order.orderId})}"
                                               th:text="${order.orderTime != null ? #temporals.format(order.orderTime, 'yyyy-MM-dd HH:mm:ss') : '-'}"
                                               style="color: #667eea; text-decoration: none; font-weight: 600;">2024-01-01 10:00:00</a>
                                        </td>
                                        <td th:text="${order.stockName ?: '-'}">Ï¢ÖÎ™©Î™Ö</td>
                                        <td th:text="${order.stockCode ?: '-'}">000000</td>
                                        <td>
                                            <span class="badge"
                                                  th:classappend="${order.side == 'BUY'} ? 'badge-buy' : 'badge-sell'"
                                                  th:text="${order.side == 'BUY'} ? 'Îß§Ïàò' : 'Îß§ÎèÑ'">
                                                Îß§Ïàò
                                            </span>
                                        </td>
                                        <td th:class="${order.side == 'BUY'} ? 'price-positive' : 'price-negative'"
                                            th:text="${order.price != null ? #numbers.formatDecimal(order.price, 0, 'COMMA', 0, 'POINT') + 'Ïõê' : '-'}">
                                            0Ïõê
                                        </td>
                                        <td th:text="${order.quantity != null ? #numbers.formatDecimal(order.quantity, 0, 'COMMA', 0, 'POINT') : '-'}">0</td>
                                        <td th:text="${order.filledQuantity != null ? #numbers.formatDecimal(order.filledQuantity, 0, 'COMMA', 0, 'POINT') : '-'}">0</td>
                                        <td>
                                            <span class="badge"
                                                  th:classappend="${order.status == 'FILLED'} ? 'badge-filled' :
                                                                 (${order.status == 'PENDING'} ? 'badge-pending' :
                                                                 (${order.status == 'CANCELLED'} ? 'badge-cancelled' : 'badge-rejected'))"
                                                  th:text="${order.status == 'FILLED'} ? 'Ï≤¥Í≤∞' :
                                                           (${order.status == 'PENDING'} ? 'ÎåÄÍ∏∞' :
                                                           (${order.status == 'CANCELLED'} ? 'Ï∑®ÏÜå' : 'Í±∞Î∂Ä'))">
                                                Ï≤¥Í≤∞
                                            </span>
                                        </td>
                                        <td>
                                            <div class="action-buttons" th:if="${order.status == 'PENDING'}">
                                                <button class="btn-modify" th:onclick="'openModifyModal(\'' + ${order.orderId} + '\', \'' + ${order.price} + '\', \'' + ${order.quantity} + '\')'">ÏàòÏ†ï</button>
                                                <form th:action="@{/trading/orders/{orderId}/cancel(orderId=${order.orderId})}" method="post" style="display: inline;">
                                                    <input type="hidden" name="accountId" th:value="${selectedAccountId}"/>
                                                    <button type="submit" class="btn-cancel" onclick="return confirm('Ï†ïÎßê Ïù¥ Ï£ºÎ¨∏ÏùÑ Ï∑®ÏÜåÌïòÏãúÍ≤†ÏäµÎãàÍπå?')">Ï∑®ÏÜå</button>
                                                </form>
                                            </div>
                                            <span th:if="${order.status != 'PENDING'}" style="color: #999;">-</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Modify Order Modal -->
                        <div id="modifyModal" class="modal">
                            <div class="modal-content">
                                <div class="modal-header">Ï£ºÎ¨∏ ÏàòÏ†ï</div>
                                <form id="modifyForm" th:action="@{/trading/orders/{orderId}/modify(orderId='')}" method="post">
                                    <input type="hidden" name="accountId" th:value="${selectedAccountId}"/>
                                    <div class="modal-form-group">
                                        <label for="newPrice">ÏÉàÎ°úÏö¥ Í∞ÄÍ≤© (Ïõê)</label>
                                        <input type="number" id="newPrice" name="newPrice" step="1" placeholder="Î≥ÄÍ≤ΩÌï† Í∞ÄÍ≤©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"/>
                                    </div>
                                    <div class="modal-form-group">
                                        <label for="newQuantity">ÏÉàÎ°úÏö¥ ÏàòÎüâ</label>
                                        <input type="number" id="newQuantity" name="newQuantity" step="1" placeholder="Î≥ÄÍ≤ΩÌï† ÏàòÎüâÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"/>
                                    </div>
                                    <div class="modal-actions">
                                        <button type="submit" class="btn-submit">ÏàòÏ†ï</button>
                                        <button type="button" class="btn-close" onclick="closeModifyModal()">Ï∑®ÏÜå</button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <script>
                            function openModifyModal(orderId, currentPrice, currentQty) {
                                document.getElementById('modifyModal').classList.add('active');
                                document.getElementById('modifyForm').action = '/trading/orders/' + orderId + '/modify';
                                document.getElementById('newPrice').value = currentPrice;
                                document.getElementById('newQuantity').value = currentQty;
                            }

                            function closeModifyModal() {
                                document.getElementById('modifyModal').classList.remove('active');
                            }

                            // Click outside modal to close
                            document.getElementById('modifyModal').addEventListener('click', function(e) {
                                if (e.target === this) {
                                    closeModifyModal();
                                }
                            });

                            // Toggle advanced filter
                            function toggleAdvancedFilter() {
                                const content = document.getElementById('advancedFilterContent');
                                const icon = document.getElementById('toggleIcon');
                                content.classList.toggle('show');
                                icon.classList.toggle('open');
                            }

                            // Reset filters
                            function resetFilters() {
                                window.location.href = '/trading/orders';
                            }

                            // Export to Excel
                            function exportToExcel() {
                                const params = new URLSearchParams(window.location.search);
                                window.location.href = '/trading/orders/export?' + params.toString();
                            }
                        </script>
        
                        <div th:if="${selectedAccountId != null && (orders == null || orders.isEmpty())}" class="empty-state">
                            <div class="empty-icon">üì≠</div>
                            <div class="empty-message">Ï°∞ÌöåÎêú Ï£ºÎ¨∏Ïù¥ ÏóÜÏäµÎãàÎã§.</div>
                        </div>
        
                        <div th:if="${selectedAccountId == null}" class="empty-state">
                            <div class="empty-icon">üìä</div>
                            <div class="empty-message">Í≥ÑÏ¢åÎ•º ÏÑ†ÌÉùÌïòÏó¨ Ï£ºÎ¨∏ ÎÇ¥Ïó≠ÏùÑ Ï°∞ÌöåÌïòÏÑ∏Ïöî.</div>
                        </div>
                    </div>
    </div>
</body>
</html>
