<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>Market Data êµ¬ë… ê´€ë¦¬</title>
    <th:block layout:fragment="extra-css">
        <style>
            .market-data-container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                padding-bottom: 40px;
            }

            .page-header {
                margin-bottom: 30px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 30px 40px;
                border-radius: 16px;
                color: white;
                box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
            }
            [data-theme="dark"] .page-header {
                background: linear-gradient(135deg, #2a2d4a 0%, #1e2139 100%);
                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }

            .page-header h2 {
                font-size: 28px;
                font-weight: 700;
                margin: 0;
                color: white;
            }

            .page-header p {
                margin: 10px 0 0 0;
                opacity: 0.9;
                font-size: 14px;
            }

            .alert {
                padding: 15px 20px;
                margin-bottom: 20px;
                border-radius: 12px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            }

            .alert-success {
                background: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }

            .alert-error {
                background: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
            }

            [data-theme="dark"] .alert-success {
                background: rgba(40, 167, 69, 0.2);
                color: #75d99b;
                border-color: rgba(40, 167, 69, 0.3);
            }

            [data-theme="dark"] .alert-error {
                background: rgba(220, 53, 69, 0.2);
                color: #f5a5ae;
                border-color: rgba(220, 53, 69, 0.3);
            }

            .card {
                background: var(--bg-secondary);
                border: none;
                border-radius: 12px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                transition: all 0.3s ease;
                margin-bottom: 20px;
            }

            .card:hover {
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            }

            .card-header {
                background: var(--bg-tertiary);
                border-bottom: 1px solid var(--border-color);
                padding: 15px 20px;
                border-radius: 12px 12px 0 0;
            }

            .card-header h5 {
                margin: 0;
                font-size: 16px;
                font-weight: 600;
                color: var(--text-primary);
            }

            .card-body {
                color: var(--text-primary);
                padding: 20px;
            }

            .status-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
            }

            .status-item {
                padding: 15px;
                background: var(--bg-tertiary);
                border-radius: 10px;
                transition: background-color 0.3s ease;
            }

            .status-label {
                font-size: 13px;
                color: var(--text-secondary);
                margin-bottom: 5px;
                font-weight: 500;
            }

            .status-value {
                font-size: 16px;
                font-weight: 600;
                color: var(--text-primary);
            }

            .status-value.active {
                color: #28a745;
            }

            .status-value.inactive {
                color: #dc3545;
            }

            .symbols-list {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                margin-top: 10px;
            }

            .symbol-tag {
                display: inline-flex;
                align-items: center;
                padding: 8px 16px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border-radius: 20px;
                font-size: 14px;
                font-weight: 500;
                box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            }

            [data-theme="dark"] .symbol-tag {
                background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            }

            .form-group {
                margin-bottom: 15px;
            }

            .form-label {
                display: block;
                font-weight: 600;
                color: var(--text-primary);
                font-size: 14px;
                margin-bottom: 8px;
            }

            .form-control {
                width: 100%;
                padding: 12px 15px;
                border: 2px solid var(--border-color);
                border-radius: 8px;
                font-size: 14px;
                background: var(--bg-tertiary);
                color: var(--text-primary);
                transition: all 0.3s ease;
                box-sizing: border-box;
            }

            .form-control:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            }

            .form-text {
                font-size: 12px;
                color: var(--text-muted);
                margin-top: 5px;
            }

            .btn {
                padding: 12px 24px;
                border: none;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 8px;
            }

            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            }

            .btn-danger {
                background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
                color: white;
                box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
            }

            .btn-danger:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(220, 53, 69, 0.4);
            }

            .btn-secondary {
                background: linear-gradient(135deg, #6c757d 0%, #545b62 100%);
                color: white;
                box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
            }

            .btn-secondary:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
            }

            [data-theme="dark"] .btn-primary,
            [data-theme="dark"] .btn-danger,
            [data-theme="dark"] .btn-secondary {
                background: #4a5568;
                box-shadow: 0 4px 15px rgba(74, 85, 104, 0.3);
            }

            [data-theme="dark"] .btn-primary:hover,
            [data-theme="dark"] .btn-danger:hover,
            [data-theme="dark"] .btn-secondary:hover {
                background: #5a6778;
            }

            .action-cards {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 20px;
            }

            .empty-symbols {
                text-align: center;
                padding: 30px;
                color: var(--text-muted);
            }

            .empty-symbols-icon {
                font-size: 48px;
                margin-bottom: 10px;
            }

            .info-box {
                background: var(--bg-secondary);
                padding: 20px;
                border-radius: 12px;
                border-left: 4px solid #667eea;
                margin-top: 20px;
                transition: background-color 0.3s ease;
            }

            [data-theme="dark"] .info-box {
                border-left-color: #8b9df0;
            }

            .info-box h3 {
                margin-top: 0;
                color: #667eea;
                font-size: 16px;
            }

            [data-theme="dark"] .info-box h3 {
                color: #8b9df0;
            }

            .info-box p {
                margin: 8px 0;
                color: var(--text-primary);
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
    </th:block>
</head>
<body>
<div layout:fragment="content">
    <div class="market-data-container">
        <!-- í˜ì´ì§€ í—¤ë” -->
        <div class="page-header">
            <h2>ğŸ“¡ Market Data êµ¬ë… ê´€ë¦¬</h2>
            <p>ì‹¤ì‹œê°„ ì‹œì„¸ ë°ì´í„° êµ¬ë… ì¢…ëª©ì„ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
        </div>

        <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
        <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

        <!-- ì„±ê³µ ë©”ì‹œì§€ -->
        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>

        <!-- êµ¬ë… ìƒíƒœ ì¹´ë“œ -->
        <div class="card" th:if="${status}">
            <div class="card-header">
                <h5>ğŸ“Š êµ¬ë… ìƒíƒœ</h5>
            </div>
            <div class="card-body">
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">êµ¬ë… ìƒíƒœ</div>
                        <div class="status-value" th:classappend="${status.subscribed ? 'active' : 'inactive'}"
                             th:text="${status.subscribed ? 'âœ… í™œì„±' : 'âŒ ë¹„í™œì„±'}">í™œì„±</div>
                    </div>
                    <div class="status-item" th:if="${status.subscriptionId}">
                        <div class="status-label">êµ¬ë… ID</div>
                        <div class="status-value" th:text="${status.subscriptionId}">-</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">ì¢…ëª© ìˆ˜</div>
                        <div class="status-value" th:text="${status.symbolCount} + 'ê°œ'">0ê°œ</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">ì—°ê²° ìƒíƒœ</div>
                        <div class="status-value" th:classappend="${status.connected ? 'active' : 'inactive'}"
                             th:text="${status.connected ? 'ğŸŸ¢ ì—°ê²°ë¨' : 'ğŸ”´ ì—°ê²° ì•ˆë¨'}">ì—°ê²°ë¨</div>
                    </div>
                </div>
                <div th:if="${status.message}" class="status-item" style="margin-top: 15px;">
                    <div class="status-label">ë©”ì‹œì§€</div>
                    <div class="status-value" th:text="${status.message}">-</div>
                </div>
            </div>
        </div>

        <!-- êµ¬ë… ì¢…ëª© ëª©ë¡ ì¹´ë“œ -->
        <div class="card" th:if="${symbols}">
            <div class="card-header">
                <h5>ğŸ“‹ êµ¬ë… ì¢…ëª© ëª©ë¡ (<span th:text="${symbols.total}">0</span>ê°œ)</h5>
            </div>
            <div class="card-body">
                <div th:if="${symbols.symbols != null and !symbols.symbols.isEmpty()}" class="symbols-list">
                    <span class="symbol-tag" th:each="symbol : ${symbols.symbols}" th:text="${symbol}">005490</span>
                </div>
                <div th:if="${symbols.symbols == null or symbols.symbols.isEmpty()}" class="empty-symbols">
                    <div class="empty-symbols-icon">ğŸ“­</div>
                    <p>êµ¬ë… ì¤‘ì¸ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <!-- ì•¡ì…˜ ì¹´ë“œë“¤ (ê·¸ë¦¬ë“œ) -->
        <div class="action-cards">
            <!-- ì¢…ëª© ì¶”ê°€ í¼ -->
            <div class="card">
                <div class="card-header">
                    <h5>â• ì¢…ëª© ì¶”ê°€</h5>
                </div>
                <div class="card-body">
                    <form th:action="@{/trading/market-data/add}" method="post">
                        <div class="form-group">
                            <label for="addSymbols" class="form-label">ì¢…ëª© ì½”ë“œ</label>
                            <input type="text" class="form-control" id="addSymbols" name="symbols"
                                   placeholder="ì˜ˆ: 005490,000270" required>
                            <div class="form-text">ì¢…ëª© ì½”ë“œë¥¼ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”.</div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <span>â•</span> ì¶”ê°€
                        </button>
                    </form>
                </div>
            </div>

            <!-- ì¢…ëª© ì‚­ì œ í¼ -->
            <div class="card">
                <div class="card-header">
                    <h5>â– ì¢…ëª© ì‚­ì œ</h5>
                </div>
                <div class="card-body">
                    <form th:action="@{/trading/market-data/remove}" method="post">
                        <div class="form-group">
                            <label for="removeSymbols" class="form-label">ì¢…ëª© ì½”ë“œ</label>
                            <input type="text" class="form-control" id="removeSymbols" name="symbols"
                                   placeholder="ì˜ˆ: 005490" required>
                            <div class="form-text">ì‚­ì œí•  ì¢…ëª© ì½”ë“œë¥¼ ì‰¼í‘œë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”.</div>
                        </div>
                        <button type="submit" class="btn btn-danger">
                            <span>ğŸ—‘ï¸</span> ì‚­ì œ
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- ì¬êµ¬ë… ì¹´ë“œ -->
        <div class="card">
            <div class="card-header">
                <h5>ğŸ”„ ì¬êµ¬ë…</h5>
            </div>
            <div class="card-body">
                <p style="margin-bottom: 15px; color: var(--text-secondary);">ëª¨ë“  êµ¬ë… ì¢…ëª©ì˜ ì—°ê²°ì„ ê°±ì‹ í•©ë‹ˆë‹¤. ì—°ê²° ë¬¸ì œê°€ ìˆì„ ë•Œ ì‚¬ìš©í•˜ì„¸ìš”.</p>
                <form th:action="@{/trading/market-data/resubscribe}" method="post">
                    <button type="submit" class="btn btn-secondary">
                        <span>ğŸ”„</span> ì¬êµ¬ë…
                    </button>
                </form>
            </div>
        </div>

        <!-- Info Box -->
        <div class="info-box">
            <h3>â„¹ï¸ Market Data êµ¬ë… ì•ˆë‚´</h3>
            <p><strong>êµ¬ë… ìƒíƒœ:</strong> í˜„ì¬ ì‹¤ì‹œê°„ ì‹œì„¸ ë°ì´í„° ìˆ˜ì‹  ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
            <p><strong>ì¢…ëª© ì¶”ê°€:</strong> ì‹¤ì‹œê°„ ì‹œì„¸ë¥¼ ë°›ê³  ì‹¶ì€ ì¢…ëª© ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
            <p><strong>ì¢…ëª© ì‚­ì œ:</strong> ë” ì´ìƒ ì‹œì„¸ë¥¼ ë°›ì§€ ì•Šì„ ì¢…ëª©ì„ êµ¬ë…ì—ì„œ ì œì™¸í•©ë‹ˆë‹¤.</p>
            <p><strong>ì¬êµ¬ë…:</strong> ì—°ê²° ë¬¸ì œ ë°œìƒ ì‹œ ëª¨ë“  ì¢…ëª©ì˜ êµ¬ë…ì„ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤.</p>
        </div>
    </div>
</div>
</body>
</html>
